/* HTX v0.1.0 :: Copyright 2019-2023 Nate Pickens :: MIT License */
(t=>{t.Renderer=class{static templateResolver(t,e,s=!1){let i,n;if("string"==typeof t?(n=`${globalThis.HTX.templates?"globalThis.HTX.templates":"globalThis"}['${t}']`,s&&console.warn(`DEPRECATED: Passing a template string to the HTX.Component constructor is deprecated. Pass a direct template function reference instead: ${n}`),i=(globalThis.HTX.templates||globalThis)[t]):(i=t,n=i?i.name||"<anonymousFunction>":"undefined"),!s&&console.warn(`DEPRECATED: new HTX(...) is deprecated. Instantiate the template directly instead: new ${n}(context)`),!i)throw`Template not found: ${t}`;return new i(e)}constructor(t,e){this.t=new WeakMap,this.i=new WeakMap,this.o={}}node(t,...e){let s,i=this.l,n=this.h,o=e.length,l=e[o-1],h=e[o-1]>>3,a=o%2==0&&e[o-2],r=`${h}:${a}`;for(1==h?this.p={}:i=i==n?n.firstChild:i.nextSibling;i&&this.t.get(i)<h;){let t=i;i=i.nextSibling,t.remove()}let c=this.t.get(i)==h,p=c&&this.i.get(i)==a;if(a&&c&&!p){let t=this.o[r];t&&(i.parentNode.insertBefore(t,i),p=!!(i=t))}if(1&l)s=p?i:4&l?document.createElementNS(e[e.indexOf("xmlns")+1||-1]||n.namespaceURI,t):document.createElement(t);else if(t&&t.render instanceof Function&&(t=t.render()),null==t&&(t=""),t instanceof Node)s=t;else if(p&&3==i.nodeType){s=i;let e=t.toString();s.nodeValue!=e&&(s.nodeValue=e)}else s=document.createTextNode(t);s!=i&&(this.t.set(s,h),this.i.set(s,a)),a&&(this.p[r]=s);for(let t=0;t<e.length-2;t+=2){let i=e[t],n=e[t+1];"class"==i&&n instanceof Array&&(n=n.filter(Boolean).join(" ")||null),"OPTION"==s.tagName&&"selected"==i&&(s[i]=n),!1===n||null==n?s.removeAttribute(i):s.setAttribute(i,!0===n?"":n)}n&&(i&&i!=n?s!=i&&n.insertBefore(s,i):n.append(s)),this.l=s,1&l&&!(2&l)&&(this.h=s)}close(t=1){for(;t-- >0;){if(this.l==this.h)for(;this.l.firstChild;)this.l.firstChild.remove();else for(;this.l.nextSibling;)this.l.nextSibling.remove();this.l=this.h,this.h=this.h.parentNode}1==this.t.get(this.l)&&(this.rootNode=this.l,this.o=this.p,delete this.p)}}})(globalThis.HTX||={}),globalThis.HTX=Object.assign((function(t,e){return globalThis.HTX.Renderer.templateResolver(t,e)}),globalThis.HTX||={});const HTX=new Proxy(globalThis.HTX,{get:(t,e,s)=>(console.warn("DEPRECATED: Top-level HTX variable has ben deprecated in favor of globalThis.HTX"),t[e])});(t=>{let e,s,i=[];function n(){for(s=null;i.length;){let[t,e]=i.shift();t.didRender(e)}}t.Component=class{constructor(e){this.template=t.Renderer.templateResolver(e,this,!0)}render(){let t=!this.node;if(t&&!e&&!s)throw"Cannot render unmounted component (call mount() instead of render())";return s=s||this,this.node=this.template.render(),this.didRender&&i.push([this,t]),e||s!=this||n(),this.node}mount(...t){e=!0;let s=t.find((t=>"string"==typeof t))||"append",i=t.find((t=>"string"!=typeof t))||document.body;if("append"!=s&&"prepend"!=s&&"before"!=s&&"after"!=s&&"replace"!=s)throw`Unrecognized placement type: ${s}`;i[s.replace("replace","replaceWith")](this.render()),e=!1,n()}}})(globalThis.HTX||={});const HTXComponent=new Proxy(globalThis.HTX.Component,{get:(t,e,s)=>("prototype"==e&&console.warn("DEPRECATED: HTXComponent has been deprecated in favor of globalThis.HTX.Component"),t[e])});
